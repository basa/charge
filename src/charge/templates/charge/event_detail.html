{% extends 'base.html' %}
{% load comments %}

{% block title %}{{ object.name }}{% endblock %}

{% block main %}
  <h2>{{ object.name }}</h2>
  <div class="well well-small">
    {% if user == object.creator %}
    <p><a href="{% url event_update object.id %}" class="btn">Edit</a>
    {% endif %}
    <p>{{ object.name }}, {{ object.location }}, {{ object.start_date }}</p>
    <p>by {{ object.creator }}</p>
    <h3>Participants</h3>
    <ul>
      {% for participant in object.participants.all %}
      <li>{{ participant }}</li>
      {% endfor %}
    </ul>

    <div class="row-fluid">
        <div class="span6">
            <h3>Items</h3>
        </div>
        <div class="span6">
            <span class="pull-right">
                <a href="{% url item_add %}" class="btn">Add Item</a>
            </span>
        </div>
    </div>

    {% if items %}
    <table class="table table-striped table-bordered table-hover">
      <thead>
      <tr>
        <th>Name</th>
        <th>Costs</th>
        <th>Creator</th>
        <th>Actions</th>
      </tr>
      </thead>
      <tbody>
      {% for item in items %}
      <tr>
        <td>{{ item.name }}</td>
        <td>{{ item.cost }}</td>
        <td>{{ item.creator }}</td>
        <td>
          {% if item.creator == user %}
          <a href="{% url item_update item.pk %}" title="Edit"><i class="icon-pencil"></i></a>
          <a href="{% url item_delete item.pk %}" title="Delete"><i class="icon-remove"></i></a>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
    {% else %}
    There are no Items.
    {% endif %}

    {% if object.creator == user %}
    <div class="form-actions">
      <a href="{% url event_delete object.pk %}" class="btn btn-danger">
        Delete Event
      </a>
    </div>
    {% endif %}

    {% render_comment_list for object %}
    {% with next=object.get_absolute_url %}
      {% render_comment_form for object %}
    {% endwith %}
  </div>
  <p><a href="{% url overview %}">Back to Overview</a></p>
{% endblock %}